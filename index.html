<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Генерация видео LongCat-Video</title>
</head>
<body>
  <h1>Генерация видео из текста и изображения</h1>
  <form id="videoForm">
    <label>
      Текст (prompt):<br />
      <input type="text" name="prompt" required />
    </label>
    <br /><br />
    <label>
      Изображение (опционально):<br />
      <input type="file" name="image" accept="image/*" />
    </label>
    <br /><br />
    <button type="submit">Сгенерировать видео</button>
  </form>

  <h2>Результат:</h2>
  <video id="resultVideo" controls style="max-width: 100%; display: none;"></video>

  <script>
    const form = document.getElementById('videoForm');
    const video = document.getElementById('resultVideo');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const formData = new FormData(form);

      video.style.display = 'none';
      video.src = '';

      try {
        const response = await fetch('http://localhost:3000/generate-video', {
          method: 'POST',
          body: formData,
        });

        if (!response.ok) {
          const errorText = await response.text();
          alert('Ошибка сервера: ' + errorText);
          return;
        }

        const data = await response.json();
        if (data.video_url) {
          video.src = data.video_url;
          video.style.display = 'block';
          video.play();
        } else {
          alert('Видео не было сгенерировано.');
        }
      } catch (err) {
        alert('Ошибка: ' + err.message);
      }
    });
  </script>
</body>
</html>
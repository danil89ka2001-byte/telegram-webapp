<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>2D Игра с Красивым Дизайном</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');

  * {
    box-sizing: border-box;
  }

  body, html {
    margin: 0;
    padding: 0;
    height: 100%;
    font-family: 'Montserrat', sans-serif;
    background: url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1350&q=80') no-repeat center center fixed;
    background-size: cover;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
  }

  #gameContainer {
    position: relative;
    width: 800px;
    height: 500px;
    background: rgba(255, 255, 255, 0.85);
    box-shadow: 0 8px 20px rgba(0,0,0,0.6);
    border-radius: 12px;
    overflow: hidden;
    user-select: none;
  }

  canvas {
    display: block;
    background: #87CEEB; /* светло-голубое небо */
    border-radius: 12px;
    box-shadow: inset 0 0 40px #a0d8ef;
  }

  #score {
    position: absolute;
    top: 10px;
    left: 20px;
    font-size: 24px;
    font-weight: 700;
    color: #222;
    text-shadow: 1px 1px 2px #fff;
  }

  #message {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 36px;
    font-weight: 700;
    color: #d32f2f;
    text-shadow: 2px 2px 3px #fff;
    display: none;
  }

  #restartBtn {
    position: absolute;
    top: 60%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: #1976d2;
    border: none;
    border-radius: 6px;
    padding: 10px 20px;
    font-size: 18px;
    font-weight: 600;
    color: white;
    cursor: pointer;
    display: none;
    box-shadow: 0 4px 10px rgba(25,118,210,0.6);
    transition: background-color 0.3s ease;
  }

  #restartBtn:hover {
    background: #115293;
  }

  h1 {
    position: absolute;
    top: 10px;
    right: 20px;
    margin: 0;
    font-size: 28px;
    font-weight: 700;
    color: #333;
    text-shadow: 1px 1px 2px #fff;
    user-select: none;
  }

</style>
</head>
<body>
  <div id="gameContainer">
    <h1>2D Игра</h1>
    <canvas id="gameCanvas" width="800" height="500"></canvas>
    <div id="score">Счёт: 0</div>
    <div id="message">Игра окончена!</div>
    <button id="restartBtn">Начать заново</button>
  </div>

<script>
  (() => {
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    const scoreEl = document.getElementById('score');
    const messageEl = document.getElementById('message');
    const restartBtn = document.getElementById('restartBtn');

    const GAME_WIDTH = canvas.width;
    const GAME_HEIGHT = canvas.height;

    // Загрузка изображений игрока, предметов и препятствий
    const imageSources = {
      player: 'https://i.imgur.com/OdL0XPt.png', // простой спрайт персонажа (48x48 px)
      item: 'https://i.imgur.com/7YbFz0x.png',   // предмет (монетка)
      obstacle: 'https://i.imgur.com/0rVehT0.png' // препятствие (шип)
    };

    function loadImage(src) {
      return new Promise(resolve => {
        const img = new Image();
        img.src = src;
        img.onload = () => resolve(img);
      });
    }

    class Player {
      constructor(img) {
        this.img = img;
        this.width = 48;
        this.height = 48;
        this.x = 50;
        this.y = GAME_HEIGHT/2 - this.height/2;
        this.speed = 5;
        this.dx = 0;
        this.dy = 0;
      }

      update(keys) {
        this.dx = 0;
        this.dy = 0;

        if (keys['ArrowUp'] || keys['w']) this.dy = -this.speed;
        if (keys['ArrowDown'] || keys['s']) this.dy = this.speed;
        if (keys['ArrowLeft'] || keys['a']) this.dx = -this.speed;
        if (keys['ArrowRight'] || keys['d']) this.dx = this.speed;

        this.x += this.dx;
        this.y += this.dy;

        // Ограничение по границам
        if (this.x < 0) this.x = 0;
        if (this.x + this.width > GAME_WIDTH) this.x = GAME_WIDTH - this.width;
        if (this.y < 0) this.y = 0;
        if (this.y + this.height > GAME_HEIGHT) this.y = GAME_HEIGHT - this.height;
      }

      draw(ctx) {
        ctx.drawImage(this.img, this.x, this.y, this.width, this.height);
      }

      getBounds() {
        return {x: this.x, y: this.y, width: this.width, height: this.height};
      }
    }

    class Item {
      constructor(img) {
        this.img = img;
        this.width = 32;
        this.height = 32;
        this.x = Math.random() * (GAME_WIDTH - this.width);
        this.y = Math.random() * (GAME_HEIGHT - this.height);
        this.collected = false;
      }

      draw(ctx) {
        if (!this.collected) {
          ctx.drawImage(this.img, this.x, this.y, this.width, this.height);
        }
      }

      getBounds() {
        return {x: this.x, y: this.y, width: this.width, height: this.height};
      }
    }

    class Obstacle {
      constructor(img, y) {
        this.img = img;
        this.width = 40;
        this.height = 40;
        this.x = GAME_WIDTH + Math.random() * 300;
        this.y = y;
        this.speed = 3 + Math.random() * 2;
      }

      update() {
        this.x -= this.speed;
        if (this.x + this.width < 0) {
          this.x = GAME_WIDTH + Math.random() * 300;
          this.speed = 3 + Math.random() * 2;
          this.y = Math.random() * (GAME_HEIGHT - this.height);
        }
      }

      draw(ctx) {
        ctx.drawImage(this.img, this.x, this.y, this.width, this.height);
      }

      getBounds() {
        return {x: this.x, y: this.y, width: this.width, height: this.height};
      }
    }

    // Проверка пересечения прямоугольников
    function isColliding(a, b) {
      return a.x < b.x + b.width &&
             a.x + a.width > b.x &&
             a.y < b.y + b.height &&
             a.y + a.height > b.y;
    }

    let player, items, obstacles;
    let keys = {};
    let score = 0;
    let gameOver = false;

    function resetGame() {
      score = 0;
      gameOver = false;
      scoreEl.textContent = 'Счёт: 0';
      messageEl.style.display = 'none';
      restartBtn.style.display = 'none';

      player.x = 50;
      player.y = GAME_HEIGHT/2 - player.height/2;

      // Сброс предметов
      items = [];
      for (let i = 0; i < 5; i++) {
        items.push(new Item(images.item));
      }

      // Сброс препятствий
      obstacles = [];
      for (let i = 0; i < 3; i++) {
        obstacles.push(new Obstacle(images.obstacle, Math.random() * (GAME_HEIGHT - 40)));
      }
    }

    const images = {};

    async function loadAssets() {
      images.player = await loadImage(imageSources.player);
      images.item = await loadImage(imageSources.item);
      images.obstacle = await loadImage(imageSources.obstacle);
    }

    function drawBackground(ctx) {
      // Небо залито цветом в стиле CSS
      // Можно добавить облака, солнце и т.п. если нужно
      // Для простоты оставим однотонный фон
    }

    function gameLoop() {
      if (gameOver) return;

      ctx.clearRect(0, 0, GAME_WIDTH, GAME_HEIGHT);

      drawBackground(ctx);

      player.update(keys);
      player.draw(ctx);

      // Отрисовка и проверка предметов
      items.forEach(item => {
        item.draw(ctx);
        if (!item.collected && isColliding(player.getBounds(), item.getBounds())) {
          item.collected = true;
          score++;
          scoreEl.textContent = 'Счёт: ' + score;
        }
      });

      // Обновление и отрисовка препятствий
      obstacles.forEach(obstacle => {
        obstacle.update();
        obstacle.draw(ctx);

        if (isColliding(player.getBounds(), obstacle.getBounds())) {
          gameOver = true;
          messageEl.style.display = 'block';
          restartBtn.style.display = 'block';
        }
      });

      requestAnimationFrame(gameLoop);
    }

    window.addEventListener('keydown', e => {
      keys[e.key.toLowerCase()] = true;
    });

    window.addEventListener('keyup', e => {
      keys[e.key.toLowerCase()] = false;
    });

    restartBtn.addEventListener('click', () => {
      resetGame();
      gameLoop();
    });

    // Запуск игры после загрузки ресурсов
    loadAssets().then(() => {
      player = new Player(images.player);
      resetGame();
      gameLoop();
    });
  })();
</script>
</body>
</html>